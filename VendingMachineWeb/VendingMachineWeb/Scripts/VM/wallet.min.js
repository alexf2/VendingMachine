define("wallet",["jquery","knockoutjs"],function(n,t){"use strict";function u(n){var r=i(this.items(),n.nominal);r<0?(r=~r,this.items.splice(r,0,{nominal:n.nominal,amount:t.observable(n.amount)})):this.items()[r].amount(this.items()[r].amount()+t.utils.unwrapObservable(n.amount))}function s(r){var f,u,e;for(n.isArray(r)||(r=[r]),f=0;f<r.length;++f){if(u=r[f],e=i(this.items(),u.nominal),e<0)return new o(u.nominal);if(this.items()[e].amount()<t.utils.unwrapObservable(u.amount))return new o(u.nominal,this.items()[e].amount()-t.utils.unwrapObservable(u.amount))}return!0}function f(n){var r=i(this.items(),n.nominal);if(r<0)throw new Error("Nominal "+n.nominal+" is not found");if(this.items()[r].amount()<t.utils.unwrapObservable(n.amount))throw new Error("Cant withdrow "+t.utils.unwrapObservable(n.amount)+" of "+n.nominal);this.items()[r].amount(this.items()[r].amount()-t.utils.unwrapObservable(n.amount))}function e(t){var i=this;n.isArray(t)?n.each(t,function(n,t){f.call(i,t)}):f.call(this,t)}function i(n,t){for(var r=0,u=n.length-1,i,f;r<=u;){if(i=r+u>>>1,f=t-n[i].nominal,f===0)return i;f<0?r=i+1:u=i-1}return~r}function o(n,t){this.nominal=n;this.amountDiff=t}var r=function(i,r,u,f){this.id=i;this.name=r;this.readonly=f||!1;var e=u||[];this.items=t.utils.arrayMap(e,function(i){if(i.nominal!==i.nominal>>0)throw new Error("Wallet does not support fractional money units");var r=n.extend({},i);return r.amount=t.observable(r.amount),r});this.items.sort(function(n,t){return t.nominal-n.nominal});this.items=t.observableArray(this.items)};return r.prototype={deposit:function(t){if(!t)throw new Error("Money to deposit are not specified");var i=this;n.isArray(t)?n.each(t,function(n,t){u.call(i,t)}):u.call(this,t)},withdraw:function(n){if(!n)throw new Error("Money to withdraw are not specified");var t=s.call(this,n);return t!==!0?t:(e.call(this,n),!0)},adjustedWithdraw:function(n){var f,r,u,t,i;if(!n)throw new Error("Amount to withdraw is not specified");for(f=n,r=[],u=0;u<this.items().length;++u)t=this.items()[u],t.nominal<=n&&(i=n/t.nominal>>0,i=Math.min(i,t.amount()),i>0&&(r.push({nominal:t.nominal,amount:i}),n-=t.nominal*i));return n===0?(e.call(this,r),r):this.getBalance()-f},withdrawAll:function(){var n=this.items();return this.items([]),n},getBalance:function(i){var u=0,r=i||this.items();return n.isArray(r)?n.each(r,function(n,i){u+=i.nominal*t.utils.unwrapObservable(i.amount)}):u+=r.nominal*t.utils.unwrapObservable(r.amount),u},getDetails:function(){return this.items()},isEmpty:function(){return this.items().length===0||this.getBalance()===0},getMoneyItem:function(n){var t=i(this.items(),n);return t>=0?this.items()[t]:null}},r});
//# sourceMappingURL=wallet.min.js.map