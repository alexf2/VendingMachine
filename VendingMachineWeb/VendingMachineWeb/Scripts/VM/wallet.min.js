(function(n){"use strict";function r(n){var i=t(this.items(),n.nominal);i<0?(i=~i,this.items.splice(i,0,{nominal:n.nominal,amount:ko.observable(n.amount)})):this.items()[i].amount(this.items()[i].amount()+ko.utils.unwrapObservable(n.amount))}function h(i){var u,r,f;for(n.isArray(i)||(i=[i]),u=0;u<i.length;++u){if(r=i[u],f=t(this.items(),r.nominal),f<0)return new e(r.nominal);if(this.items()[f].amount()<ko.utils.unwrapObservable(r.amount))return new e(r.nominal,this.items()[f].amount()-ko.utils.unwrapObservable(r.amount))}return!0}function u(n){var i=t(this.items(),n.nominal);if(i<0)throw new Error("Nominal "+n.nominal+" is not found");if(this.items()[i].amount()<ko.utils.unwrapObservable(n.amount))throw new Error("Cant withdrow "+ko.utils.unwrapObservable(n.amount)+" of "+n.nominal);this.items()[i].amount(this.items()[i].amount()-ko.utils.unwrapObservable(n.amount))}function f(t){var i=this;n.isArray(t)?n.each(t,function(n,t){u.call(i,t)}):u.call(this,t)}function t(n,t){for(var r=0,u=n.length-1,i,f;r<=u;){if(i=r+u>>>1,f=t-n[i].nominal,f===0)return i;f<0?r=i+1:u=i-1}return~r}function e(n,t){this.nominal=n;this.amountDiff=t}var i="VmSimulator",o=n[i]||(n[i]={}),s=o.Wallet=function(t,i,r,u){this.id=t;this.name=i;this.readonly=u||!1;var f=r||[];this.items=ko.utils.arrayMap(f,function(t){if(t.nominal!==t.nominal>>0)throw new Error("Wallet does not support fractional money units");var i=n.extend({},t);return i.amount=ko.observable(i.amount),i});this.items.sort(function(n,t){return t.nominal-n.nominal});this.items=ko.observableArray(this.items)};s.prototype={deposit:function(t){if(!t)throw new Error("Money to deposit are not specified");var i=this;n.isArray(t)?n.each(t,function(n,t){r.call(i,t)}):r.call(this,t)},withdraw:function(n){if(!n)throw new Error("Money to withdraw are not specified");var t=h.call(this,n);return t!==!0?t:(f.call(this,n),!0)},adjustedWithdraw:function(n){var e,r,u,t,i;if(!n)throw new Error("Amount to withdraw is not specified");for(e=n,r=[],u=0;u<this.items().length;++u)t=this.items()[u],t.nominal<=n&&(i=n/t.nominal>>0,i=Math.min(i,t.amount()),i>0&&(r.push({nominal:t.nominal,amount:i}),n-=t.nominal*i));return n===0?(f.call(this,r),r):this.getBalance()-e},withdrawAll:function(){var n=this.items();return this.items([]),n},getBalance:function(t){var r=0,i=t||this.items();return n.isArray(i)?n.each(i,function(n,t){r+=t.nominal*ko.utils.unwrapObservable(t.amount)}):r+=i.nominal*ko.utils.unwrapObservable(i.amount),r},getDetails:function(){return this.items()},isEmpty:function(){return this.items().length===0||this.getBalance()===0},getMoneyItem:function(n){var i=t(this.items(),n);return i>=0?this.items()[i]:null}}})(window.jQuery);
//# sourceMappingURL=wallet.min.js.map