define("goods-store",["jquery","purcashing-result","knockoutjs"],function(n,t,i){"use strict";var r=function(t,r){var u=t||[];this.items=i.utils.arrayMap(u,function(t){var r=n.extend({},t);return r.countInPieces=i.observable(r.countInPieces),r});this.wallet=r};return r.prototype={purchase:function(i,r){for(var e,o,u,f=0;f<this.items.length;++f)if(this.items[f].name===i){u=this.items[f];break}if(!u)throw new Error("Goods "+i+" is not found");if(u.countInPieces()<1)return new t(t.prototype.RUN_OUT);if(e=this.wallet.getBalance(r),e<u.price)return new t(t.prototype.NOT_ENOUGHT_MONEY);if(this.wallet.deposit(r),e!==u.price&&(o=this.wallet.adjustedWithdraw(e-u.price),n.isNumeric(o))){if(this.wallet.withdraw(r)!==!0)throw new Error("Inconsistent wallet "+this.name);return new t(t.prototype.NO_CHANGE,o)}return u.countInPieces(u.countInPieces()-1),new t(t.prototype.SOLD_OK,o)}},r});
//# sourceMappingURL=goods-store.min.js.map