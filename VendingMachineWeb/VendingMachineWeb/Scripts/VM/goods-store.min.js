!function(n){"use strict";function t(n,t){this.status=n;this.change=t}var i="VmSimulator",r=n[i]||(n[i]={}),u=r.GoodsStore=function(t,i){var r=t||[];this.items=ko.utils.arrayMap(r,function(t){var i=n.extend({},t);return i.countInPieces=ko.observable(i.countInPieces),i});this.wallet=i};u.prototype={purchase:function(i,r){for(var e,o,u,f=0;f<this.items.length;++f)if(this.items[f].name===i){u=this.items[f];break}if(!u)throw new Error("Goods "+i+" is not found");if(u.countInPieces()<1)return new t(t.prototype.RUN_OUT);if(e=this.wallet.getBalance(r),e<u.price)return new t(t.prototype.NOT_ENOUGHT_MONEY);if(this.wallet.deposit(r),e!==u.price&&(o=this.wallet.adjustedWithdraw(e-u.price),n.isNumeric(o))){if(this.wallet.withdraw(r)!==!0)throw new Error("Inconsistent wallet "+this.name);return new t(t.prototype.NO_CHANGE,o)}return u.countInPieces(u.countInPieces()-1),new t(t.prototype.SOLD_OK,o)}};t.prototype={RUN_OUT:0,NOT_ENOUGHT_MONEY:-1,NO_CHANGE:-2,SOLD_OK:1};r.PurcashingResult=t}(window.jQuery);
//# sourceMappingURL=goods-store.min.js.map